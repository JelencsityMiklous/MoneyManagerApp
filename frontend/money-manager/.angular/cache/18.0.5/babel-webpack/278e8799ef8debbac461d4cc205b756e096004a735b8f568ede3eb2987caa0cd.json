{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nexport let AuthService = /*#__PURE__*/(() => {\n  class AuthService {\n    constructor(router) {\n      this.router = router;\n      this.usersKey = 'mm_users';\n      this.currentKey = 'mm_current_user';\n      this.ensureAdminExists();\n    }\n    ensureAdminExists() {\n      const users = this.readUsers();\n      if (!users.find(u => u.email === 'admin@admin')) {\n        const id = users.length ? Math.max(...users.map(u => u.id)) + 1 : 1;\n        const admin = {\n          id,\n          name: 'Admin',\n          email: 'admin@admin',\n          password: 'admin123',\n          isAdmin: true,\n          wallet: {\n            balance: 0,\n            income: 0,\n            expense: 0\n          }\n        };\n        users.push(admin);\n        this.writeUsers(users);\n      }\n    }\n    readUsers() {\n      const raw = localStorage.getItem(this.usersKey);\n      return raw ? JSON.parse(raw) : [];\n    }\n    writeUsers(u) {\n      localStorage.setItem(this.usersKey, JSON.stringify(u));\n    }\n    register(name, email, password) {\n      const users = this.readUsers();\n      if (users.find(x => x.email === email)) {\n        return {\n          success: false,\n          message: 'Ez az email már regisztrálva van.'\n        };\n      }\n      const id = users.length ? Math.max(...users.map(u => u.id)) + 1 : 1;\n      const user = {\n        id,\n        name,\n        email,\n        password,\n        isAdmin: false,\n        wallet: {\n          balance: 0,\n          income: 0,\n          expense: 0\n        }\n      };\n      users.push(user);\n      this.writeUsers(users);\n      localStorage.setItem(this.currentKey, JSON.stringify(user));\n      return {\n        success: true,\n        message: 'Sikeres regisztráció.'\n      };\n    }\n    login(email, password) {\n      const users = this.readUsers();\n      const user = users.find(x => x.email === email && x.password === password);\n      if (!user) return {\n        success: false,\n        message: 'Hibás email vagy jelszó.'\n      };\n      localStorage.setItem(this.currentKey, JSON.stringify(user));\n      return {\n        success: true,\n        message: 'Bejelentkezés sikeres.'\n      };\n    }\n    logout() {\n      localStorage.removeItem(this.currentKey);\n      this.router.navigate(['/']);\n    }\n    get isLoggedIn() {\n      return !!localStorage.getItem(this.currentKey);\n    }\n    getCurrentUser() {\n      const raw = localStorage.getItem(this.currentKey);\n      return raw ? JSON.parse(raw) : null;\n    }\n    updateCurrent(updated) {\n      // update both current and stored users\n      localStorage.setItem(this.currentKey, JSON.stringify(updated));\n      const users = this.readUsers();\n      const idx = users.findIndex(u => u.id === updated.id);\n      if (idx >= 0) {\n        users[idx] = updated;\n        this.writeUsers(users);\n      }\n    }\n    static {\n      this.ɵfac = function AuthService_Factory(t) {\n        return new (t || AuthService)(i0.ɵɵinject(i1.Router));\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: AuthService,\n        factory: AuthService.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return AuthService;\n})();","map":{"version":3,"names":["AuthService","constructor","router","usersKey","currentKey","ensureAdminExists","users","readUsers","find","u","email","id","length","Math","max","map","admin","name","password","isAdmin","wallet","balance","income","expense","push","writeUsers","raw","localStorage","getItem","JSON","parse","setItem","stringify","register","x","success","message","user","login","logout","removeItem","navigate","isLoggedIn","getCurrentUser","updateCurrent","updated","idx","findIndex","i0","ɵɵinject","i1","Router","factory","ɵfac","providedIn"],"sources":["C:\\Users\\Attila\\íyc\\MoneyManagerApp\\frontend\\money-manager\\src\\app\\services\\auth.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\n\r\nexport interface AppUser {\r\n  isAdmin?: boolean;\r\n  id: number;\r\n  name: string;\r\n  email: string;\r\n  password: string;\r\n  wallet: { balance: number; income: number; expense: number; };\r\n}\r\n\r\n@Injectable({ providedIn: 'root' })\r\nexport class AuthService {\r\n  [x: string]: any;\r\n  constructor(private router: Router) { this.ensureAdminExists(); }\r\n\r\n  private ensureAdminExists() {\r\n    const users = this.readUsers();\r\n    if (!users.find(u => u.email === 'admin@admin')) {\r\n      const id = users.length ? Math.max(...users.map(u => u.id)) + 1 : 1;\r\n      const admin = { id, name: 'Admin', email: 'admin@admin', password: 'admin123', isAdmin: true, wallet: { balance: 0, income: 0, expense: 0 } };\r\n      users.push(admin);\r\n      this.writeUsers(users);\r\n    }\r\n  }\r\n\r\n\r\n  private usersKey = 'mm_users';\r\n  private currentKey = 'mm_current_user';\r\n\r\n  private readUsers(): AppUser[] {\r\n    const raw = localStorage.getItem(this.usersKey);\r\n    return raw ? JSON.parse(raw) : [];\r\n  }\r\n  private writeUsers(u: AppUser[]) {\r\n    localStorage.setItem(this.usersKey, JSON.stringify(u));\r\n  }\r\n\r\n  register(name: string, email: string, password: string): { success: boolean, message: string } {\r\n    const users = this.readUsers();\r\n    if (users.find(x => x.email === email)) {\r\n      return { success: false, message: 'Ez az email már regisztrálva van.' };\r\n    }\r\n    const id = users.length ? Math.max(...users.map(u => u.id)) + 1 : 1;\r\n    const user: AppUser = { id, name, email, password, isAdmin: false, wallet: { balance: 0, income: 0, expense: 0 } };\r\n    users.push(user);\r\n    this.writeUsers(users);\r\n    localStorage.setItem(this.currentKey, JSON.stringify(user));\r\n    return { success: true, message: 'Sikeres regisztráció.' };\r\n  }\r\n\r\n  login(email: string, password: string): { success: boolean, message: string } {\r\n    const users = this.readUsers();\r\n    const user = users.find(x => x.email === email && x.password === password);\r\n    if (!user) return { success: false, message: 'Hibás email vagy jelszó.' };\r\n    localStorage.setItem(this.currentKey, JSON.stringify(user));\r\n    return { success: true, message: 'Bejelentkezés sikeres.' };\r\n  }\r\n\r\n  logout() {\r\n    localStorage.removeItem(this.currentKey);\r\n    this.router.navigate(['/']);\r\n  }\r\n  \r\n  get isLoggedIn(): boolean {\r\n    return !!localStorage.getItem(this.currentKey);\r\n  }\r\n\r\n  getCurrentUser(): AppUser | null {\r\n    const raw = localStorage.getItem(this.currentKey);\r\n    return raw ? JSON.parse(raw) as AppUser : null;\r\n  }\r\n\r\n  updateCurrent(updated: AppUser) {\r\n    // update both current and stored users\r\n    localStorage.setItem(this.currentKey, JSON.stringify(updated));\r\n    const users = this.readUsers();\r\n    const idx = users.findIndex(u => u.id === updated.id);\r\n    if (idx >= 0) {\r\n      users[idx] = updated;\r\n      this.writeUsers(users);\r\n    }\r\n  }\r\n}"],"mappings":";;AAaA,WAAaA,WAAW;EAAlB,MAAOA,WAAW;IAEtBC,YAAoBC,MAAc;MAAd,KAAAA,MAAM,GAANA,MAAM;MAalB,KAAAC,QAAQ,GAAG,UAAU;MACrB,KAAAC,UAAU,GAAG,iBAAiB;MAdA,IAAI,CAACC,iBAAiB,EAAE;IAAE;IAExDA,iBAAiBA,CAAA;MACvB,MAAMC,KAAK,GAAG,IAAI,CAACC,SAAS,EAAE;MAC9B,IAAI,CAACD,KAAK,CAACE,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,KAAK,KAAK,aAAa,CAAC,EAAE;QAC/C,MAAMC,EAAE,GAAGL,KAAK,CAACM,MAAM,GAAGC,IAAI,CAACC,GAAG,CAAC,GAAGR,KAAK,CAACS,GAAG,CAACN,CAAC,IAAIA,CAAC,CAACE,EAAE,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC;QACnE,MAAMK,KAAK,GAAG;UAAEL,EAAE;UAAEM,IAAI,EAAE,OAAO;UAAEP,KAAK,EAAE,aAAa;UAAEQ,QAAQ,EAAE,UAAU;UAAEC,OAAO,EAAE,IAAI;UAAEC,MAAM,EAAE;YAAEC,OAAO,EAAE,CAAC;YAAEC,MAAM,EAAE,CAAC;YAAEC,OAAO,EAAE;UAAC;QAAE,CAAE;QAC7IjB,KAAK,CAACkB,IAAI,CAACR,KAAK,CAAC;QACjB,IAAI,CAACS,UAAU,CAACnB,KAAK,CAAC;MACxB;IACF;IAMQC,SAASA,CAAA;MACf,MAAMmB,GAAG,GAAGC,YAAY,CAACC,OAAO,CAAC,IAAI,CAACzB,QAAQ,CAAC;MAC/C,OAAOuB,GAAG,GAAGG,IAAI,CAACC,KAAK,CAACJ,GAAG,CAAC,GAAG,EAAE;IACnC;IACQD,UAAUA,CAAChB,CAAY;MAC7BkB,YAAY,CAACI,OAAO,CAAC,IAAI,CAAC5B,QAAQ,EAAE0B,IAAI,CAACG,SAAS,CAACvB,CAAC,CAAC,CAAC;IACxD;IAEAwB,QAAQA,CAAChB,IAAY,EAAEP,KAAa,EAAEQ,QAAgB;MACpD,MAAMZ,KAAK,GAAG,IAAI,CAACC,SAAS,EAAE;MAC9B,IAAID,KAAK,CAACE,IAAI,CAAC0B,CAAC,IAAIA,CAAC,CAACxB,KAAK,KAAKA,KAAK,CAAC,EAAE;QACtC,OAAO;UAAEyB,OAAO,EAAE,KAAK;UAAEC,OAAO,EAAE;QAAmC,CAAE;MACzE;MACA,MAAMzB,EAAE,GAAGL,KAAK,CAACM,MAAM,GAAGC,IAAI,CAACC,GAAG,CAAC,GAAGR,KAAK,CAACS,GAAG,CAACN,CAAC,IAAIA,CAAC,CAACE,EAAE,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC;MACnE,MAAM0B,IAAI,GAAY;QAAE1B,EAAE;QAAEM,IAAI;QAAEP,KAAK;QAAEQ,QAAQ;QAAEC,OAAO,EAAE,KAAK;QAAEC,MAAM,EAAE;UAAEC,OAAO,EAAE,CAAC;UAAEC,MAAM,EAAE,CAAC;UAAEC,OAAO,EAAE;QAAC;MAAE,CAAE;MAClHjB,KAAK,CAACkB,IAAI,CAACa,IAAI,CAAC;MAChB,IAAI,CAACZ,UAAU,CAACnB,KAAK,CAAC;MACtBqB,YAAY,CAACI,OAAO,CAAC,IAAI,CAAC3B,UAAU,EAAEyB,IAAI,CAACG,SAAS,CAACK,IAAI,CAAC,CAAC;MAC3D,OAAO;QAAEF,OAAO,EAAE,IAAI;QAAEC,OAAO,EAAE;MAAuB,CAAE;IAC5D;IAEAE,KAAKA,CAAC5B,KAAa,EAAEQ,QAAgB;MACnC,MAAMZ,KAAK,GAAG,IAAI,CAACC,SAAS,EAAE;MAC9B,MAAM8B,IAAI,GAAG/B,KAAK,CAACE,IAAI,CAAC0B,CAAC,IAAIA,CAAC,CAACxB,KAAK,KAAKA,KAAK,IAAIwB,CAAC,CAAChB,QAAQ,KAAKA,QAAQ,CAAC;MAC1E,IAAI,CAACmB,IAAI,EAAE,OAAO;QAAEF,OAAO,EAAE,KAAK;QAAEC,OAAO,EAAE;MAA0B,CAAE;MACzET,YAAY,CAACI,OAAO,CAAC,IAAI,CAAC3B,UAAU,EAAEyB,IAAI,CAACG,SAAS,CAACK,IAAI,CAAC,CAAC;MAC3D,OAAO;QAAEF,OAAO,EAAE,IAAI;QAAEC,OAAO,EAAE;MAAwB,CAAE;IAC7D;IAEAG,MAAMA,CAAA;MACJZ,YAAY,CAACa,UAAU,CAAC,IAAI,CAACpC,UAAU,CAAC;MACxC,IAAI,CAACF,MAAM,CAACuC,QAAQ,CAAC,CAAC,GAAG,CAAC,CAAC;IAC7B;IAEA,IAAIC,UAAUA,CAAA;MACZ,OAAO,CAAC,CAACf,YAAY,CAACC,OAAO,CAAC,IAAI,CAACxB,UAAU,CAAC;IAChD;IAEAuC,cAAcA,CAAA;MACZ,MAAMjB,GAAG,GAAGC,YAAY,CAACC,OAAO,CAAC,IAAI,CAACxB,UAAU,CAAC;MACjD,OAAOsB,GAAG,GAAGG,IAAI,CAACC,KAAK,CAACJ,GAAG,CAAY,GAAG,IAAI;IAChD;IAEAkB,aAAaA,CAACC,OAAgB;MAC5B;MACAlB,YAAY,CAACI,OAAO,CAAC,IAAI,CAAC3B,UAAU,EAAEyB,IAAI,CAACG,SAAS,CAACa,OAAO,CAAC,CAAC;MAC9D,MAAMvC,KAAK,GAAG,IAAI,CAACC,SAAS,EAAE;MAC9B,MAAMuC,GAAG,GAAGxC,KAAK,CAACyC,SAAS,CAACtC,CAAC,IAAIA,CAAC,CAACE,EAAE,KAAKkC,OAAO,CAAClC,EAAE,CAAC;MACrD,IAAImC,GAAG,IAAI,CAAC,EAAE;QACZxC,KAAK,CAACwC,GAAG,CAAC,GAAGD,OAAO;QACpB,IAAI,CAACpB,UAAU,CAACnB,KAAK,CAAC;MACxB;IACF;;;yBAtEWN,WAAW,EAAAgD,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,MAAA;MAAA;IAAA;;;eAAXnD,WAAW;QAAAoD,OAAA,EAAXpD,WAAW,CAAAqD,IAAA;QAAAC,UAAA,EADE;MAAM;IAAA;;SACnBtD,WAAW;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}