{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"./auth.service\";\nexport let TransactionService = /*#__PURE__*/(() => {\n  class TransactionService {\n    constructor(auth) {\n      this.auth = auth;\n    }\n    getWallet() {\n      const user = this.auth.getCurrentUser();\n      if (user) return user.wallet;\n      // guest state\n      const raw = localStorage.getItem('mm_guest_wallet');\n      if (raw) return JSON.parse(raw);\n      const w = {\n        balance: 0,\n        income: 0,\n        expense: 0\n      };\n      localStorage.setItem('mm_guest_wallet', JSON.stringify(w));\n      return w;\n    }\n    add(amount) {\n      const user = this.auth.getCurrentUser();\n      if (user) {\n        user.wallet.income += amount;\n        user.wallet.balance += amount;\n        this.auth.updateCurrent(user);\n      } else {\n        const w = this.getWallet();\n        w.income += amount;\n        w.balance += amount;\n        localStorage.setItem('mm_guest_wallet', JSON.stringify(w));\n      }\n    }\n    spend(amount) {\n      const user = this.auth.getCurrentUser();\n      if (user) {\n        user.wallet.expense += amount;\n        user.wallet.balance -= amount;\n        this.auth.updateCurrent(user);\n      } else {\n        const w = this.getWallet();\n        w.expense += amount;\n        w.balance -= amount;\n        localStorage.setItem('mm_guest_wallet', JSON.stringify(w));\n      }\n    }\n    static {\n      this.ɵfac = function TransactionService_Factory(t) {\n        return new (t || TransactionService)(i0.ɵɵinject(i1.AuthService));\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: TransactionService,\n        factory: TransactionService.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return TransactionService;\n})();","map":{"version":3,"names":["TransactionService","constructor","auth","getWallet","user","getCurrentUser","wallet","raw","localStorage","getItem","JSON","parse","w","balance","income","expense","setItem","stringify","add","amount","updateCurrent","spend","i0","ɵɵinject","i1","AuthService","factory","ɵfac","providedIn"],"sources":["C:\\Users\\Attila\\íyc\\MoneyManagerApp\\frontend\\money-manager\\src\\app\\services\\transaction.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { AuthService, AppUser } from './auth.service';\r\n\r\n@Injectable({ providedIn: 'root' })\r\nexport class TransactionService {\r\n  constructor(private auth: AuthService) {}\r\n\r\n  getWallet() {\r\n    const user = this.auth.getCurrentUser();\r\n    if (user) return user.wallet;\r\n    // guest state\r\n    const raw = localStorage.getItem('mm_guest_wallet');\r\n    if (raw) return JSON.parse(raw);\r\n    const w = { balance: 0, income: 0, expense: 0 };\r\n    localStorage.setItem('mm_guest_wallet', JSON.stringify(w));\r\n    return w;\r\n  }\r\n\r\n  add(amount:number) {\r\n    const user = this.auth.getCurrentUser();\r\n    if (user) {\r\n      user.wallet.income += amount;\r\n      user.wallet.balance += amount;\r\n      this.auth.updateCurrent(user as AppUser);\r\n    } else {\r\n      const w = this.getWallet();\r\n      w.income += amount;\r\n      w.balance += amount;\r\n      localStorage.setItem('mm_guest_wallet', JSON.stringify(w));\r\n    }\r\n  }\r\n\r\n  spend(amount:number) {\r\n    const user = this.auth.getCurrentUser();\r\n    if (user) {\r\n      user.wallet.expense += amount;\r\n      user.wallet.balance -= amount;\r\n      this.auth.updateCurrent(user as AppUser);\r\n    } else {\r\n      const w = this.getWallet();\r\n      w.expense += amount;\r\n      w.balance -= amount;\r\n      localStorage.setItem('mm_guest_wallet', JSON.stringify(w));\r\n    }\r\n  }\r\n}"],"mappings":";;AAIA,WAAaA,kBAAkB;EAAzB,MAAOA,kBAAkB;IAC7BC,YAAoBC,IAAiB;MAAjB,KAAAA,IAAI,GAAJA,IAAI;IAAgB;IAExCC,SAASA,CAAA;MACP,MAAMC,IAAI,GAAG,IAAI,CAACF,IAAI,CAACG,cAAc,EAAE;MACvC,IAAID,IAAI,EAAE,OAAOA,IAAI,CAACE,MAAM;MAC5B;MACA,MAAMC,GAAG,GAAGC,YAAY,CAACC,OAAO,CAAC,iBAAiB,CAAC;MACnD,IAAIF,GAAG,EAAE,OAAOG,IAAI,CAACC,KAAK,CAACJ,GAAG,CAAC;MAC/B,MAAMK,CAAC,GAAG;QAAEC,OAAO,EAAE,CAAC;QAAEC,MAAM,EAAE,CAAC;QAAEC,OAAO,EAAE;MAAC,CAAE;MAC/CP,YAAY,CAACQ,OAAO,CAAC,iBAAiB,EAAEN,IAAI,CAACO,SAAS,CAACL,CAAC,CAAC,CAAC;MAC1D,OAAOA,CAAC;IACV;IAEAM,GAAGA,CAACC,MAAa;MACf,MAAMf,IAAI,GAAG,IAAI,CAACF,IAAI,CAACG,cAAc,EAAE;MACvC,IAAID,IAAI,EAAE;QACRA,IAAI,CAACE,MAAM,CAACQ,MAAM,IAAIK,MAAM;QAC5Bf,IAAI,CAACE,MAAM,CAACO,OAAO,IAAIM,MAAM;QAC7B,IAAI,CAACjB,IAAI,CAACkB,aAAa,CAAChB,IAAe,CAAC;MAC1C,CAAC,MAAM;QACL,MAAMQ,CAAC,GAAG,IAAI,CAACT,SAAS,EAAE;QAC1BS,CAAC,CAACE,MAAM,IAAIK,MAAM;QAClBP,CAAC,CAACC,OAAO,IAAIM,MAAM;QACnBX,YAAY,CAACQ,OAAO,CAAC,iBAAiB,EAAEN,IAAI,CAACO,SAAS,CAACL,CAAC,CAAC,CAAC;MAC5D;IACF;IAEAS,KAAKA,CAACF,MAAa;MACjB,MAAMf,IAAI,GAAG,IAAI,CAACF,IAAI,CAACG,cAAc,EAAE;MACvC,IAAID,IAAI,EAAE;QACRA,IAAI,CAACE,MAAM,CAACS,OAAO,IAAII,MAAM;QAC7Bf,IAAI,CAACE,MAAM,CAACO,OAAO,IAAIM,MAAM;QAC7B,IAAI,CAACjB,IAAI,CAACkB,aAAa,CAAChB,IAAe,CAAC;MAC1C,CAAC,MAAM;QACL,MAAMQ,CAAC,GAAG,IAAI,CAACT,SAAS,EAAE;QAC1BS,CAAC,CAACG,OAAO,IAAII,MAAM;QACnBP,CAAC,CAACC,OAAO,IAAIM,MAAM;QACnBX,YAAY,CAACQ,OAAO,CAAC,iBAAiB,EAAEN,IAAI,CAACO,SAAS,CAACL,CAAC,CAAC,CAAC;MAC5D;IACF;;;yBAxCWZ,kBAAkB,EAAAsB,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,WAAA;MAAA;IAAA;;;eAAlBzB,kBAAkB;QAAA0B,OAAA,EAAlB1B,kBAAkB,CAAA2B,IAAA;QAAAC,UAAA,EADL;MAAM;IAAA;;SACnB5B,kBAAkB;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}